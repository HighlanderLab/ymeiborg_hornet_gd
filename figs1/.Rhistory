library(dplyr
)
.libPaths()
.libPaths()
library(dplyr)
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/fig2a")
source("../model_function.R")
load("~/Roslin Hornets/ymeiborg_hornet_gd/fig2a/Fig2a.Rdata")
PaperTheme <- theme_bw(base_size = 11, base_family = "sans") +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
title=element_text(size=14, hjust=0.5),
legend.title=element_text(size=12),
legend.position = "bottom",
legend.justification = "center",
axis.title=element_text(size=12),
plot.title = element_text(hjust = 0.5))
modelOutput <- as_tibble(modelOutput)
modelOutput <- mutate(modelOutput,
strategy = factor(strategy),
N = factor(N),
nGD = factor(nGD),
k = factor(k),
gdSex = factor(gdSex),
rmax = factor(rmax),
generations = factor(generations),
repetitions = factor(repetitions),
pHMort = factor(pHMort),
pHMort = factor(pHMort))
haploRep <- as_tibble(modelOutput) %>%
select(strategy, gdSex, generation, repetitions, WT:RE, N, nGD, k) %>%
pivot_longer(cols = WT:RE) %>%
rename("Release" = gdSex, Allele = name, Frequency = value)
haploRep$strategy = factor(haploRep$strategy,
levels = c(1,2,3,4),
labels = c("Neutral",
"Male infertility",
"Female infertility",
"Both-sex infertility"))
haploRep$`Release` = factor(haploRep$`Release`,
levels = c(1,2),
labels = c("Females","Males"))
filter(haploRep,
(generation == 25 & Release == "Males" & strategy == "Neutral") &
(Allele == "GD" & Frequency == 0)) |> nrow() -> maleFail
fig2a <- ggplot(data = haploRep) +
facet_grid(
`Release` ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(
x = generation,
y = Frequency,
group = interaction(Allele, repetitions),
colour = Allele
)) +
scale_colour_manual(values = alpha(colour = met.brewer("Greek", 4),
alpha = 0.15)) +
guides(colour = guide_legend(override.aes = list(alpha = 1))) +
xlab("Generation") +
ggtitle("Asian hornet") +
PaperTheme
fig2a
popRep <- as_tibble(modelOutput) %>%
select(popSizeF, strategy, gdSex, generation, repetitions) %>%
rename(Release = gdSex) %>%
mutate(Release = factor(Release,
levels = c(1,2),
labels = c("Females","Males")),
strategy= factor(strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility",
"Female infertility",
"Both-sex infertility")))
figs0a <- ggplot(data = popRep) +
facet_grid(
Release ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(x = generation,
y = popSizeF,
group = repetitions),
alpha = 0.1) +
ylim(0, 1200) +
xlab("Generation") +
ylab("Female population size") +
ggtitle("Asian hornet") +
PaperTheme
figs0a
ggsave(plot = fig2a, filename = "Fig2a.png", height = 12, width = 20, unit = "cm")
save(modelOutput, fig2a, file = "Fig2a.Rdata")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/fig2b")
source("../model_function.R")
load("~/Roslin Hornets/ymeiborg_hornet_gd/fig2b/Fig2b.Rdata")
PaperTheme <- theme_bw(base_size = 11, base_family = "sans") +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
title=element_text(size=14, hjust=0.5),
legend.title=element_text(size=12),
legend.position = "bottom",
legend.justification = "center",
axis.title=element_text(size=12),
plot.title = element_text(hjust = 0.5))
modelOutput <- as_tibble(modelOutput)
modelOutput <- mutate(modelOutput,
strategy = factor(strategy),
N = factor(N),
nGD = factor(nGD),
k = factor(k),
gdSex = factor(gdSex),
rmax = factor(rmax),
generations = factor(generations),
repetitions = factor(repetitions),
pHMort = factor(pHMort),
cutRate = factor(cutRate))
haploRep <- as_tibble(modelOutput) %>%
select(strategy, gdSex, generation, repetitions, WT:RE, N, nGD, k) %>%
pivot_longer(cols = WT:RE) %>%
rename("Release" = gdSex, Allele = name, Frequency = value)
haploRep$strategy = factor(haploRep$strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility","Female infertility","Both-sex infertility"))
haploRep$`Release` = factor(haploRep$`Release`,
levels = c(1,2),
labels = c("Females","Males"))
filter(haploRep,
(generation == 25 & Release == "Males" & strategy == "Neutral") &
(Allele == "GD" & Frequency == 0)) |> nrow() -> maleFail
fig2b <- ggplot(data = haploRep) +
facet_grid(
`Release` ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(
x = generation,
y = Frequency,
group = interaction(Allele, repetitions),
colour = Allele
)) +
scale_colour_manual(values = alpha(colour = met.brewer("Greek", 4),
alpha = 0.15)) +
guides(colour = guide_legend(override.aes = list(alpha = 1))) +
xlab("Generation") +
ggtitle("European paper wasp") +
PaperTheme
fig2b
popRep <- as_tibble(modelOutput) %>%
select(popSizeF, strategy, gdSex, generation, repetitions) %>%
rename(Release = gdSex) %>%
mutate(Release = factor(Release,
levels = c(1,2),
labels = c("Females","Males")),
strategy= factor(strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility",
"Female infertility",
"Both-sex infertility")))
figs0b <- ggplot(data = popRep) +
facet_grid(
Release ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(x = generation,
y = popSizeF,
group = repetitions),
alpha = 0.1) +
ylim(0, 1200) +
xlab("Generation") +
ylab("Female population size") +
ggtitle("European paper wasp") +
PaperTheme
figs0b
#########################################
########## Save model ###################
#########################################
ggsave(plot = fig2b, filename = "Fig2b.png", height = 12, width = 20, unit = "cm")
save(modelOutput, fig2b, file = "Fig2b.Rdata")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/fig2")
source("../model_function.R")
#############################
######## load data ##########
#############################
load(file = "../fig2a/Fig2a.Rdata")
load(file = "../fig2b/Fig2b.Rdata")
#########################################
########## Plot plots ###################
#########################################
fig2 <- fig2a / fig2b +
plot_layout(guides = 'collect') & theme(legend.position='bottom') &
plot_annotation(tag_levels = 'a') &
theme(plot.tag = element_text(size = 14))
fig2
ggsave(plot = fig2, filename = "Fig2.png", height = 25, width = 20, unit = "cm")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/figs0")
source("../model_function.R")
#############################
######## load data ##########
#############################
load(file = "../fig2a/FigS0a.Rdata")
load(file = "../fig2b/FigS0b.Rdata")
#########################################
########## Plot plots ###################
#########################################
figs0 <- figs0a / figs0b +
plot_layout(guides = 'collect') & theme(legend.position='bottom') &
plot_annotation(tag_levels = 'a') &
theme(plot.tag = element_text(size = 14))
figs0
ggsave(plot = figs0, filename = "FigS0.png", height = 18, width = 20, unit = "cm")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/fig2a")
source("../model_function.R")
PaperTheme <- theme_bw(base_size = 11, base_family = "sans") +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
title=element_text(size=14, hjust=0.5),
legend.title=element_text(size=12),
legend.position = "bottom",
legend.justification = "center",
axis.title=element_text(size=12),
plot.title = element_text(hjust = 0.5))
modelOutput <- as_tibble(modelOutput)
modelOutput <- mutate(modelOutput,
strategy = factor(strategy),
N = factor(N),
nGD = factor(nGD),
k = factor(k),
gdSex = factor(gdSex),
rmax = factor(rmax),
generations = factor(generations),
repetitions = factor(repetitions),
pHMort = factor(pHMort),
pHMort = factor(pHMort))
haploRep <- as_tibble(modelOutput) %>%
select(strategy, gdSex, generation, repetitions, WT:RE, N, nGD, k) %>%
pivot_longer(cols = WT:RE) %>%
rename("Release" = gdSex, Allele = name, Frequency = value)
haploRep$strategy = factor(haploRep$strategy,
levels = c(1,2,3,4),
labels = c("Neutral",
"Male infertility",
"Female infertility",
"Both-sex infertility"))
haploRep$`Release` = factor(haploRep$`Release`,
levels = c(1,2),
labels = c("Females","Males"))
filter(haploRep,
(generation == 25 & Release == "Males" & strategy == "Neutral") &
(Allele == "GD" & Frequency == 0)) |> nrow() -> maleFail
fig2a <- ggplot(data = haploRep) +
facet_grid(
`Release` ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(
x = generation,
y = Frequency,
group = interaction(Allele, repetitions),
colour = Allele
)) +
scale_colour_manual(values = alpha(colour = met.brewer("Greek", 4),
alpha = 0.15)) +
guides(colour = guide_legend(override.aes = list(alpha = 1))) +
xlab("Generation") +
ggtitle("Asian hornet") +
PaperTheme
fig2a
popRep <- as_tibble(modelOutput) %>%
select(popSizeF, strategy, gdSex, generation, repetitions) %>%
rename(Release = gdSex) %>%
mutate(Release = factor(Release,
levels = c(1,2),
labels = c("Females","Males")),
strategy= factor(strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility",
"Female infertility",
"Both-sex infertility")))
figs0a <- ggplot(data = popRep) +
facet_grid(
Release ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(x = generation,
y = popSizeF,
group = repetitions),
alpha = 0.1) +
ylim(0, 1200) +
xlab("Generation") +
ylab("Female population size") +
ggtitle("Asian hornet") +
PaperTheme
figs0a
#########################################
########## Save model ###################
#########################################
ggsave(plot = fig2a, filename = "Fig2a.png", height = 12, width = 20, unit = "cm")
save(modelOutput, fig2a, file = "Fig2a.Rdata")
ggsave(plot = figs0a, filename = "FigS0a.png", height = 12, width = 20, unit = "cm")
save(figs0a, file = "FigS0a.Rdata")
load("~/Roslin Hornets/ymeiborg_hornet_gd/fig2a/Fig2a.Rdata")
PaperTheme <- theme_bw(base_size = 11, base_family = "sans") +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
title=element_text(size=14, hjust=0.5),
legend.title=element_text(size=12),
legend.position = "bottom",
legend.justification = "center",
axis.title=element_text(size=12),
plot.title = element_text(hjust = 0.5))
modelOutput <- as_tibble(modelOutput)
modelOutput <- mutate(modelOutput,
strategy = factor(strategy),
N = factor(N),
nGD = factor(nGD),
k = factor(k),
gdSex = factor(gdSex),
rmax = factor(rmax),
generations = factor(generations),
repetitions = factor(repetitions),
pHMort = factor(pHMort),
pHMort = factor(pHMort))
haploRep <- as_tibble(modelOutput) %>%
select(strategy, gdSex, generation, repetitions, WT:RE, N, nGD, k) %>%
pivot_longer(cols = WT:RE) %>%
rename("Release" = gdSex, Allele = name, Frequency = value)
haploRep$strategy = factor(haploRep$strategy,
levels = c(1,2,3,4),
labels = c("Neutral",
"Male infertility",
"Female infertility",
"Both-sex infertility"))
haploRep$`Release` = factor(haploRep$`Release`,
levels = c(1,2),
labels = c("Females","Males"))
filter(haploRep,
(generation == 25 & Release == "Males" & strategy == "Neutral") &
(Allele == "GD" & Frequency == 0)) |> nrow() -> maleFail
fig2a <- ggplot(data = haploRep) +
facet_grid(
`Release` ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(
x = generation,
y = Frequency,
group = interaction(Allele, repetitions),
colour = Allele
)) +
scale_colour_manual(values = alpha(colour = met.brewer("Greek", 4),
alpha = 0.15)) +
guides(colour = guide_legend(override.aes = list(alpha = 1))) +
xlab("Generation") +
ggtitle("Asian hornet") +
PaperTheme
fig2a
popRep <- as_tibble(modelOutput) %>%
select(popSizeF, strategy, gdSex, generation, repetitions) %>%
rename(Release = gdSex) %>%
mutate(Release = factor(Release,
levels = c(1,2),
labels = c("Females","Males")),
strategy= factor(strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility",
"Female infertility",
"Both-sex infertility")))
figs0a <- ggplot(data = popRep) +
facet_grid(
Release ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(x = generation,
y = popSizeF,
group = repetitions),
alpha = 0.1) +
ylim(0, 1200) +
xlab("Generation") +
ylab("Female population size") +
ggtitle("Asian hornet") +
PaperTheme
figs0a
#########################################
########## Save model ###################
#########################################
ggsave(plot = fig2a, filename = "Fig2a.png", height = 12, width = 20, unit = "cm")
save(modelOutput, fig2a, file = "Fig2a.Rdata")
ggsave(plot = figs0a, filename = "FigS0a.png", height = 12, width = 20, unit = "cm")
save(figs0a, file = "FigS0a.Rdata")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/fig2b")
source("../model_function.R")
load("~/Roslin Hornets/ymeiborg_hornet_gd/fig2b/Fig2b.Rdata")
PaperTheme <- theme_bw(base_size = 11, base_family = "sans") +
theme(strip.background = element_blank(),
panel.grid = element_blank(),
title=element_text(size=14, hjust=0.5),
legend.title=element_text(size=12),
legend.position = "bottom",
legend.justification = "center",
axis.title=element_text(size=12),
plot.title = element_text(hjust = 0.5))
modelOutput <- as_tibble(modelOutput)
modelOutput <- mutate(modelOutput,
strategy = factor(strategy),
N = factor(N),
nGD = factor(nGD),
k = factor(k),
gdSex = factor(gdSex),
rmax = factor(rmax),
generations = factor(generations),
repetitions = factor(repetitions),
pHMort = factor(pHMort),
cutRate = factor(cutRate))
haploRep <- as_tibble(modelOutput) %>%
select(strategy, gdSex, generation, repetitions, WT:RE, N, nGD, k) %>%
pivot_longer(cols = WT:RE) %>%
rename("Release" = gdSex, Allele = name, Frequency = value)
haploRep$strategy = factor(haploRep$strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility","Female infertility","Both-sex infertility"))
haploRep$`Release` = factor(haploRep$`Release`,
levels = c(1,2),
labels = c("Females","Males"))
filter(haploRep,
(generation == 25 & Release == "Males" & strategy == "Neutral") &
(Allele == "GD" & Frequency == 0)) |> nrow() -> maleFail
fig2b <- ggplot(data = haploRep) +
facet_grid(
`Release` ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(
x = generation,
y = Frequency,
group = interaction(Allele, repetitions),
colour = Allele
)) +
scale_colour_manual(values = alpha(colour = met.brewer("Greek", 4),
alpha = 0.15)) +
guides(colour = guide_legend(override.aes = list(alpha = 1))) +
xlab("Generation") +
ggtitle("European paper wasp") +
PaperTheme
fig2b
popRep <- as_tibble(modelOutput) %>%
select(popSizeF, strategy, gdSex, generation, repetitions) %>%
rename(Release = gdSex) %>%
mutate(Release = factor(Release,
levels = c(1,2),
labels = c("Females","Males")),
strategy= factor(strategy,
levels = c(1,2,3,4),
labels = c("Neutral","Male infertility",
"Female infertility",
"Both-sex infertility")))
figs0b <- ggplot(data = popRep) +
facet_grid(
Release ~ strategy,
scales = "fixed",
labeller = labeller(.cols = label_value, .rows = label_both)
) +
geom_line(aes(x = generation,
y = popSizeF,
group = repetitions),
alpha = 0.1) +
ylim(0, 1200) +
xlab("Generation") +
ylab("Female population size") +
ggtitle("European paper wasp") +
PaperTheme
figs0b
#########################################
########## Save model ###################
#########################################
ggsave(plot = fig2b, filename = "Fig2b.png", height = 12, width = 20, unit = "cm")
save(modelOutput, fig2b, file = "Fig2b.Rdata")
ggsave(plot = figs0b, filename = "FigS0a.png", height = 12, width = 20, unit = "cm")
save(figs0b, file = "FigS0b.Rdata")
setwd("~/Roslin Hornets/ymeiborg_hornet_gd/figs0")
source("../model_function.R")
#############################
######## load data ##########
#############################
load(file = "../fig2a/FigS0a.Rdata")
load(file = "../fig2b/FigS0b.Rdata")
#########################################
########## Plot plots ###################
#########################################
figs0 <- figs0a / figs0b +
plot_layout(guides = 'collect') & theme(legend.position='bottom') &
plot_annotation(tag_levels = 'a') &
theme(plot.tag = element_text(size = 14))
figs0
ggsave(plot = figs0, filename = "FigS0.png", height = 18, width = 20, unit = "cm")
